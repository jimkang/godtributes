var emoji = require('node-emoji');
var probable = require('probable');
var _ = require('lodash');

var boringEmoji = {
  '100': 'ğŸ’¯',
  '1234': 'ğŸ”¢',
  currency_exchange: 'ğŸ’±',
  stuck_out_tongue: 'ğŸ˜›',
  no_pedestrians: 'ğŸš·',
  pisces: 'â™“ï¸',
  six_pointed_star: 'ğŸ”¯',
  signal_strength: 'ğŸ“¶',
  expressionless: 'ğŸ˜‘',
  us: 'ğŸ‡ºğŸ‡¸',
  wink: 'ğŸ˜‰',
  kissing_closed_eyes: 'ğŸ˜š',
  confused: 'ğŸ˜•',
  yum: 'ğŸ˜‹',
  relieved: 'ğŸ˜Œ',
  arrows_counterclockwise: 'ğŸ”„',
  mobile_phone_off: 'ğŸ“´',
  es: 'ğŸ‡ªğŸ‡¸',
  flushed: 'ğŸ˜³',
  cl: 'ğŸ†‘',
  stuck_out_tongue_closed_eyes: 'ğŸ˜',
  ab: 'ğŸ†',
  wc: 'ğŸš¾',
  mens: 'ğŸš¹',
  blush: 'ğŸ˜Š',
  cry: 'ğŸ˜¢',
  capricorn: 'â™‘ï¸',
  part_alternation_mark: 'ã€½ï€ƒï¸',
  angry: 'ğŸ˜ ',
  wheelchair: 'â™¿ï¸',
  rage: 'ğŸ˜¡',
  abc: 'ğŸ”¤',
  v: 'âœŒï¸',
  passport_control: 'ğŸ›‚',
  no_mouth: 'ğŸ˜¶',
  congratulations: 'ãŠ—ï€ƒï¸',
  white_check_mark: 'âœ…',
  u6e80: 'ğŸˆµ',
  up: 'ğŸ†™',
  point_down: 'ğŸ‘‡',
  bangbang: 'â€¼ï¸',
  persevere: 'ğŸ˜£',
  libra: 'â™ï¸',
  '+1': 'ğŸ‘',
  'non-potable_water': 'ğŸš±',
  u5408: 'ğŸˆ´',
  open_mouth: 'ğŸ˜®',
  m: 'â“‚ï¸',
  '-1': 'ğŸ‘',
  smiley_cat: 'ğŸ˜º',
  arrow_heading_down: 'â¤µï¸',
  cn: 'ğŸ‡¨ğŸ‡³',
  aries: 'â™ˆï¸',
  sweat_smile: 'ğŸ˜…',
  jp: 'ğŸ‡¯ğŸ‡µ',
  scream: 'ğŸ˜±',
  cool: 'ğŸ†’',
  top: 'ğŸ”',
  hash: '#ï¸âƒ£',
  u6307: 'ğŸˆ¯ï€ƒï¸',
  new: 'ğŸ†•',
  back: 'ğŸ”™',
  fearful: 'ğŸ˜¨',
  ru: 'ğŸ‡·ğŸ‡º',
  cinema: 'ğŸ¦',
  restroom: 'ğŸš»',
  keycap_ten: 'ğŸ”Ÿ',
  no_mobile_phones: 'ğŸ“µ',
  abcd: 'ğŸ”¡',
  imp: 'ğŸ‘¿',
  scorpius: 'â™ï¸',
  negative_squared_cross_mark: 'â',
  atm: 'ğŸ§',
  underage: 'ğŸ”',
  u6709: 'ğŸˆ¶',
  it: 'ğŸ‡®ğŸ‡¹',
  sagittarius: 'â™ï¸',
  astonished: 'ğŸ˜²',
  sun_with_face: 'ğŸŒ',
  five: '5ï¸âƒ£',
  heart_eyes: 'ğŸ˜',
  mask: 'ğŸ˜·',
  frowning: 'ğŸ˜¦',
  laughing: 'ğŸ˜†',
  left_luggage: 'ğŸ›…',
  kissing_smiling_eyes: 'ğŸ˜™',
  do_not_litter: 'ğŸš¯',
  sweat: 'ğŸ˜“',
  anguished: 'ğŸ˜§',
  information_source: 'â„¹ï¸',
  gemini: 'â™Šï¸',
  ideograph_advantage: 'ğŸ‰',
  gb: 'ğŸ‡¬ğŸ‡§',
  accept: 'ğŸ‰‘',
  two: '2ï¸âƒ£',
  chart: 'ğŸ’¹',
  point_left: 'ğŸ‘ˆ',
  nine: '9ï¸âƒ£',
  no_bicycles: 'ğŸš³',
  smile: 'ğŸ˜„',
  end: 'ğŸ”š',
  worried: 'ğŸ˜Ÿ',
  six: '6ï¸âƒ£',
  ng: 'ğŸ†–',
  repeat_one: 'ğŸ”‚',
  baggage_claim: 'ğŸ›„',
  zero: '0ï¸âƒ£',
  no_smoking: 'ğŸš­',
  u7533: 'ğŸˆ¸',
  kissing_heart: 'ğŸ˜˜',
  virgo: 'â™ï¸',
  fr: 'ğŸ‡«ğŸ‡·',
  free: 'ğŸ†“',
  joy: 'ğŸ˜‚',
  b: 'ğŸ…±',
  pensive: 'ğŸ˜”',
  tired_face: 'ğŸ˜«',
  dizzy_face: 'ğŸ˜µ',
  sunglasses: 'ğŸ˜',
  baby_symbol: 'ğŸš¼',
  seven: '7ï¸âƒ£',
  a: 'ğŸ…°',
  fast_forward: 'â©',
  u7a7a: 'ğŸˆ³',
  neutral_face: 'ğŸ˜',
  unamused: 'ğŸ˜’',
  soon: 'ğŸ”œ',
  sob: 'ğŸ˜­',
  kr: 'ğŸ‡°ğŸ‡·',
  ok: 'ğŸ†—',
  three: '3ï¸âƒ£',
  ophiuchus: 'â›',
  o2: 'ğŸ…¾',
  customs: 'ğŸ›ƒ',
  leo: 'â™Œï¸',
  u5272: 'ğŸˆ¹',
  smirk: 'ğŸ˜',
  question: 'â“',
  sos: 'ğŸ†˜',
  one: '1ï¸âƒ£',
  o: 'â­•ï¸',
  smiley: 'ğŸ˜ƒ',
  vibration_mode: 'ğŸ“³',
  put_litter_in_its_place: 'ğŸš®',
  id: 'ğŸ†”',
  hushed: 'ğŸ˜¯',
  symbols: 'ğŸ”£',
  grinning: 'ğŸ˜€',
  grin: 'ğŸ˜',
  four: '4ï¸âƒ£',
  no_entry: 'â›”ï¸',
  woman: 'ğŸ‘©',
  four_leaf_clover: 'ğŸ€',
  waning_gibbous_moon: 'ğŸŒ–',
  x: 'âŒ',
  koko: 'ğŸˆ',
  heart_decoration: 'ğŸ’Ÿ',
  innocent: 'ğŸ˜‡',
  rewind: 'âª',
  disappointed: 'ğŸ˜',
  vs: 'ğŸ†š',
  disappointed_relieved: 'ğŸ˜¥',
  grey_exclamation: 'â•',
  weary: 'ğŸ˜©',
  parking: 'ğŸ…¿ï¸',
  triumph: 'ğŸ˜¤',
  taurus: 'â™‰ï¸',
  sa: 'ğŸˆ‚',
  cancer: 'â™‹ï¸',
  stuck_out_tongue_winking_eye: 'ğŸ˜œ',
  sleeping: 'ğŸ˜´',
  kissing: 'ğŸ˜—',
  loop: 'â¿',
  capital_abcd: 'ğŸ” ',
  aquarius: 'â™’ï¸',
  u7121: 'ğŸˆšï€ƒï¸',
  u6708: 'ğŸˆ·',
  de: 'ğŸ‡©ğŸ‡ª',
  repeat: 'ğŸ”',
  confounded: 'ğŸ˜–'
};

function getRandomTopicEmoji() {
  var emojiKey = probable.pickFromArray(getEmojiKeysForTopics());
  return emoji.get(emojiKey);
}

var emojiKeysForTopics;

function getEmojiKeysForTopics() {
  if (!emojiKeysForTopics) {
    emojiKeysForTopics = Object.keys(emoji.emoji)
      .filter(emojiKeyIsOKAsATopic);
  }
  return emojiKeysForTopics;
}

function emojiKeyIsOKAsATopic(key) {
  return key.indexOf('arrow') === -1 &&
    !(key in boringEmoji);
}

function emojiValueIsOKAsATopic(value) {
  var isInBoringEmoji = _.some(boringEmoji, 
    function valueMatches(boringValue) {
      return boringValue === value;
    }
  );
  return !isInBoringEmoji;
}

module.exports = {
  getRandomTopicEmoji: getRandomTopicEmoji,
  emojiValueIsOKAsATopic: emojiValueIsOKAsATopic
};
